<!DOCTYPE html>
<html>
<head>
    <title>KG Simple Test</title>
    <script type="text/javascript" src="https://unpkg.com/vis-network/standalone/umd/vis-network.min.js"></script>
    <style>
        #network {
            width: 100%;
            height: 400px;
            border: 1px solid #ccc;
        }
    </style>
</head>
<body>
    <h1>Knowledge Graph Simple Test</h1>
    <div id="network"></div>
    
    <script>
        // Fetch real data from API
        fetch('http://localhost:8000/api/kg/run_877f5ab2')
            .then(response => response.json())
            .then(data => {
                console.log('Fetched data:', data);
                
                // Prepare nodes and edges for vis-network
                const nodes = new vis.DataSet(data.nodes.map(node => ({
                    id: node.id,
                    label: node.label,
                    group: node.group,
                    title: node.title,
                    color: {
                        background: node.color || getNodeColor(node.group),
                        border: '#2B7CE9',
                        highlight: {
                            background: '#FFA500',
                            border: '#FF0000'
                        }
                    },
                    shape: 'box',
                    font: {
                        color: '#000000',
                        size: 12
                    }
                })));

                const edges = new vis.DataSet(data.edges.map(edge => ({
                    from: edge.from,
                    to: edge.to,
                    label: edge.label,
                    color: {
                        color: edge.color || '#848484',
                        highlight: '#FF0000'
                    },
                    arrows: {
                        to: {
                            enabled: true,
                            scaleFactor: 1
                        }
                    }
                })));

                const container = document.getElementById('network');
                const networkData = { nodes, edges };

                const options = {
                    nodes: {
                        shape: 'box',
                        margin: 10,
                        font: {
                            size: 12,
                            color: '#000000'
                        }
                    },
                    edges: {
                        width: 2,
                        color: { color: '#848484' },
                        arrows: {
                            to: { enabled: true, scaleFactor: 1 }
                        }
                    },
                    physics: {
                        enabled: true,
                        stabilization: { iterations: 100 }
                    },
                    interaction: {
                        hover: true,
                        selectConnectedEdges: false
                    }
                };

                const network = new vis.Network(container, networkData, options);
            })
            .catch(error => {
                console.error('Error fetching data:', error);
                document.getElementById('network').innerHTML = '<p>Error loading knowledge graph</p>';
            });

        function getNodeColor(group) {
            const colors = {
                'Run': '#FF6B6B',
                'Reference': '#4ECDC4', 
                'Aligner': '#45B7D1',
                'Caller': '#96CEB4',
                'VCF': '#FFEAA7',
                'Annotator': '#DDA0DD',
                'DBVersion': '#98D8C8'
            }
            return colors[group] || '#CCCCCC'
        }
    </script>
</body>
</html>